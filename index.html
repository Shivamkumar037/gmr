<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>GMR Service - Professional Task Platform</title>
    
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Font Awesome Pro CDN -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Manrope:wght@300;400;500;600;700;800&family=Outfit:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">

    <!-- Configuration -->
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        brand: {
                            50: '#f0fdf4',
                            100: '#dcfce7',
                            200: '#bbf7d0',
                            300: '#86efac',
                            400: '#4ade80',
                            500: '#22c55e', // Main Green
                            600: '#16a34a',
                            700: '#15803d',
                            800: '#166534',
                            900: '#14532d',
                            950: '#052e16',
                        },
                        accent: {
                            50: '#eff6ff',
                            100: '#dbeafe',
                            500: '#3b82f6', // Blue
                            600: '#2563eb',
                            900: '#1e3a8a',
                        },
                        dark: {
                            800: '#1e293b',
                            900: '#0f172a',
                            950: '#020617',
                        },
                        surface: '#ffffff',
                        background: '#f8fafc',
                    },
                    fontFamily: {
                        sans: ['"Manrope"', 'sans-serif'],
                        display: ['"Outfit"', 'sans-serif'],
                    },
                    boxShadow: {
                        'soft': '0 4px 20px -2px rgba(0, 0, 0, 0.05)',
                        'card': '0 0 0 1px rgba(0,0,0,0.03), 0 2px 8px rgba(0,0,0,0.04)',
                        'card-hover': '0 0 0 1px rgba(0,0,0,0.03), 0 8px 16px rgba(0,0,0,0.08)',
                        'nav': '0 -4px 20px rgba(0,0,0,0.03)',
                        'glow': '0 0 20px rgba(34, 197, 94, 0.4)',
                        'button': '0 4px 6px -1px rgba(34, 197, 94, 0.2), 0 2px 4px -1px rgba(34, 197, 94, 0.1)',
                    },
                    animation: {
                        'fade-in': 'fadeIn 0.4s cubic-bezier(0.4, 0, 0.2, 1)',
                        'slide-up': 'slideUp 0.5s cubic-bezier(0.4, 0, 0.2, 1)',
                        'slide-down': 'slideDown 0.3s ease-out',
                        'scale-in': 'scaleIn 0.3s cubic-bezier(0.4, 0, 0.2, 1)',
                        'pulse-slow': 'pulse 3s cubic-bezier(0.4, 0, 0.6, 1) infinite',
                        'float': 'float 3s ease-in-out infinite',
                    },
                    keyframes: {
                        fadeIn: { '0%': { opacity: '0' }, '100%': { opacity: '1' } },
                        slideUp: { '0%': { transform: 'translateY(20px)', opacity: '0' }, '100%': { transform: 'translateY(0)', opacity: '1' } },
                        slideDown: { '0%': { transform: 'translateY(-20px)', opacity: '0' }, '100%': { transform: 'translateY(0)', opacity: '1' } },
                        scaleIn: { '0%': { transform: 'scale(0.95)', opacity: '0' }, '100%': { transform: 'scale(1)', opacity: '1' } },
                        float: { '0%, 100%': { transform: 'translateY(0)' }, '50%': { transform: 'translateY(-5px)' } },
                    }
                }
            }
        }
    </script>

    <style>
        /* === RESET & BASE === */
        :root {
            --nav-height: 70px;
            --header-height: 64px;
        }

        body { 
            background-color: #f8fafc;
            color: #1e293b;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            overflow-x: hidden;
        }

        /* Scrollbar Styling */
        ::-webkit-scrollbar { width: 6px; height: 6px; }
        ::-webkit-scrollbar-track { background: transparent; }
        ::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 10px; }
        ::-webkit-scrollbar-thumb:hover { background: #94a3b8; }

        /* Mobile Optimization */
        .pb-safe { padding-bottom: calc(var(--nav-height) + env(safe-area-inset-bottom) + 20px); }
        .pt-safe { padding-top: calc(var(--header-height) + env(safe-area-inset-top)); }
        
        /* Interactive Elements */
        .clickable { cursor: pointer; user-select: none; -webkit-tap-highlight-color: transparent; }
        .clickable:active { transform: scale(0.98); }

        /* Loaders */
        .spinner {
            width: 24px; height: 24px;
            border: 3px solid rgba(255,255,255,0.3);
            border-radius: 50%;
            border-top-color: #fff;
            animation: spin 1s ease-in-out infinite;
        }
        @keyframes spin { to { transform: rotate(360deg); } }

        /* Task Images */
        .img-cover {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.5s ease;
        }
        .card-container:hover .img-cover { transform: scale(1.05); }

        /* Navigation Active State */
        .nav-link { 
            color: #94a3b8; 
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
        }
        .nav-link.active { color: #16a34a; }
        .nav-link.active i { transform: translateY(-2px); filter: drop-shadow(0 4px 6px rgba(22, 163, 74, 0.2)); }
        .nav-link.active::after {
            content: '';
            position: absolute;
            bottom: -8px;
            left: 50%;
            transform: translateX(-50%);
            width: 20px;
            height: 3px;
            background: #16a34a;
            border-radius: 10px;
        }

        /* Modal Transitions */
        .modal-overlay { transition: opacity 0.3s ease; }
        .modal-content { transition: transform 0.3s cubic-bezier(0.34, 1.56, 0.64, 1); }
        
        /* Sticky Details Header Fix */
        .details-header {
            position: sticky;
            top: 0;
            z-index: 40;
            background: rgba(255,255,255,0.95);
            backdrop-filter: blur(12px);
            border-bottom: 1px solid #f1f5f9;
        }
    </style>
</head>
<body class="selection:bg-brand-100 selection:text-brand-900">

    <!-- === JAVASCRIPT LOGIC ENGINE === -->
    <script>
        // --- 1. SYSTEM CONFIGURATION ---
        const SYS = {
            version: '4.2.0-Pro',
            currency: '‚Çπ',
            minWithdraw: 500,
            animationDuration: 300,
            mockDelay: 1500
        };

        // --- 2. STATE MANAGEMENT ---
        let AppState = JSON.parse(localStorage.getItem('gmr_pro_v4_state')) || {
            user: {
                id: 'USR-' + Math.floor(Math.random() * 1000000),
                name: null,
                mobile: null,
                email: null,
                joined: new Date().toISOString(),
                isLoggedIn: false,
                vipTier: 'Starter'
            },
            wallet: {
                // --- INITIAL BALANCE (Change this value to test) ---
                balance: 0.00, 
                // --------------------------------------------------
                pending: 0.00,
                totalWithdrawn: 0.00,
                paymentFailures: 0
            },
            tasks: {
                completed: [], // Array of IDs
                dailyCount: 0,
                lastReset: new Date().toDateString()
            },
            history: [] // Transactions
        };

        // --- 3. MOCK DATABASE (EXTENSIVE) ---
        const MOCK_DB = {
            tasks: [],
            leaderboard: [],
            faqs: [
                {q: "Is my payment guaranteed?", a: "Yes, we use secure IMPS/NEFT transfers. Payments are processed within 24 hours."},
                {q: "How to increase earnings?", a: "Upgrade your VIP tier or refer friends to earn 10% of their earnings forever."},
                {q: "Why did verification fail?", a: "Ensure your screenshot clearly shows your 5-star rating and the review text."},
                {q: "What is the minimum withdrawal?", a: "The minimum withdrawal amount is ‚Çπ500. There are no fees for withdrawal."}
            ]
        };

        // Generate Tasks Function
      // Generate Tasks Function (Updated with Your Data)
      function generateMockData() {
    if (MOCK_DB.tasks.length > 0) return;

   const rawData = [
  {p:"Mumbai Urban Brew House", i:"https://images.unsplash.com/photo-1521017432531-fbd92d768814", c:"18", m:"https://www.google.com/maps/search/Mumbai+Urban+Brew+House"},
  {p:"Delhi Spice Avenue", i:"https://images.unsplash.com/photo-1528605248644-14dd04022da1", c:"23", m:"https://www.google.com/maps/search/Delhi+Spice+Avenue"},
  {p:"Bengaluru Metro Caf√©", i:"https://images.unsplash.com/photo-1504754524776-8f4f37790ca0", c:"29", m:"https://www.google.com/maps/search/Bengaluru+Metro+Cafe"},
  {p:"Kolkata Fiction House Cafe", i:"https://images.unsplash.com/photo-1517248135467-4c7edcad34c4", c:"17", m:"https://www.google.com/maps/search/Kolkata+Fiction+House+Cafe"},
  {p:"Chennai Ocean Breeze Diner", i:"https://images.unsplash.com/photo-1529692236671-f1a85f34a79b", c:"22", m:"https://www.google.com/maps/search/Chennai+Ocean+Breeze+Diner"},
  {p:"Hyderabad Royal Tea Point", i:"https://images.unsplash.com/photo-1598514982747-1f2e2e1c8a34", c:"20", m:"https://www.google.com/maps/search/Hyderabad+Royal+Tea+Point"},
  {p:"Pune College Adda Cafe", i:"https://images.unsplash.com/photo-1504674900247-0877df9cc836", c:"16", m:"https://www.google.com/maps/search/Pune+College+Adda+Cafe"},
  {p:"Jaipur Hawa Mahal Lounge", i:"https://images.unsplash.com/photo-1551782450-a2132b4ba21d", c:"28", m:"https://www.google.com/maps/search/Jaipur+Hawa+Mahal+Lounge"},
  {p:"Lucknow Royal Awadhi Corner", i:"https://images.unsplash.com/photo-1551218808-94e220e084d2", c:"21", m:"https://www.google.com/maps/search/Lucknow+Royal+Awadhi+Corner"},
  {p:"Indore Namkeen Street Hub", i:"https://images.unsplash.com/photo-1546069901-ba9599a7e63c", c:"27", m:"https://www.google.com/maps/search/Indore+Namkeen+Street+Hub"},

  {p:"Ahmedabad Taste Villa", i:"https://images.unsplash.com/photo-1521302080473-3b0c22039cc4", c:"23", m:"https://www.google.com/maps/search/Ahmedabad+Taste+Villa"},
  {p:"Surat Diamond City Snacks", i:"https://images.unsplash.com/photo-1554151228-14d9def656e4", c:"23", m:"https://www.google.com/maps/search/Surat+Diamond+City+Snacks"},
  {p:"Nagpur Orange City Dhaba", i:"https://images.unsplash.com/photo-1600891975654-dc2ebc18deed", c:"26", m:"https://www.google.com/maps/search/Nagpur+Orange+City+Dhaba"},
  {p:"Patna Heritage Caf√©", i:"https://images.unsplash.com/photo-1504754524776-8f4f37790ca0", c:"18", m:"https://www.google.com/maps/search/Patna+Heritage+Cafe"},
  {p:"Guwahati Riverside Tea Point", i:"https://images.unsplash.com/photo-1498654896293-37aacf113fd9", c:"24", m:"https://www.google.com/maps/search/Guwahati+Riverside+Tea+Point"},
  {p:"Chandigarh City Center Caf√©", i:"https://images.unsplash.com/photo-1559311648-dc66c1c8d5c0", c:"26", m:"https://www.google.com/maps/search/Chandigarh+City+Center+Cafe"},
  {p:"Bhopal Upper Lake Caf√©", i:"https://images.unsplash.com/photo-1528605248644-14dd04022da1", c:"21", m:"https://www.google.com/maps/search/Bhopal+Upper+Lake+Cafe"},
  {p:"Vadodara Royal Bakery", i:"https://images.unsplash.com/photo-1495474472287-4d71bcdd2085", c:"23", m:"https://www.google.com/maps/search/Vadodara+Royal+Bakery"},
  {p:"Ranchi Junction Snacks", i:"https://images.unsplash.com/photo-1600891963937-a5083577a9a2", c:"22", m:"https://www.google.com/maps/search/Ranchi+Junction+Snacks"},
  {p:"Jabalpur Old Town Tea House", i:"https://images.unsplash.com/photo-1565895405138-6c3a122e8b3b", c:"26", m:"https://www.google.com/maps/search/Jabalpur+Old+Town+Tea+House"},

  {p:"Agra Taj View Caf√©", i:"https://images.unsplash.com/photo-1504674900247-0877df9cc836", c:"15", m:"https://www.google.com/maps/search/Agra+Taj+View+Cafe"},
  {p:"Varanasi Ganga Aarti Caf√©", i:"https://images.unsplash.com/photo-1598514982747-1f2e2e1c8a34", c:"30", m:"https://www.google.com/maps/search/Varanasi+Ganga+Aarti+Cafe"},
  {p:"Udaipur Lake Palace Lounge", i:"https://images.unsplash.com/photo-1517685352821-92cf88aee5a5", c:"17", m:"https://www.google.com/maps/search/Udaipur+Lake+Palace+Lounge"},
  {p:"Kota Coaching Hub Diner", i:"https://images.unsplash.com/photo-1555992336-cbfdda0a4f87", c:"19", m:"https://www.google.com/maps/search/Kota+Coaching+Hub+Diner"},
  {p:"Gwalior Fort View Caf√©", i:"https://images.unsplash.com/photo-1504754524776-8f4f37790ca0", c:"29", m:"https://www.google.com/maps/search/Gwalior+Fort+View+Cafe"},
  {p:"Noida Sector 62 Tech Cafe", i:"https://images.unsplash.com/photo-1552566626-52f8b828add9", c:"22", m:"https://www.google.com/maps/search/Noida+Sector+62+Tech+Cafe"},
  {p:"Gurgaon Digital Hub Cafe", i:"https://images.unsplash.com/photo-1551782450-a2132b4ba21d", c:"26", m:"https://www.google.com/maps/search/Gurgaon+Digital+Hub+Cafe"},
  {p:"Faridabad Street Treats", i:"https://images.unsplash.com/photo-1551218808-94e220e084d2", c:"23", m:"https://www.google.com/maps/search/Faridabad+Street+Treats"},
  {p:"Meerut Mughal Treats", i:"https://images.unsplash.com/photo-1521302080473-3b0c22039cc4", c:"24", m:"https://www.google.com/maps/search/Meerut+Mughal+Treats"},
  {p:"Kanpur Nawabi Sweets", i:"https://images.unsplash.com/photo-1546069901-ba9599a7e63c", c:"27", m:"https://www.google.com/maps/search/Kanpur+Nawabi+Sweets"},

  {p:"Aligarh Old City Tea Point", i:"https://images.unsplash.com/photo-1504674900247-0877df9cc836", c:"29", m:"https://www.google.com/maps/search/Aligarh+Old+City+Tea+Point"},
  {p:"Moradabad Brass City Caf√©", i:"https://images.unsplash.com/photo-1598514982747-1f2e2e1c8a34", c:"16", m:"https://www.google.com/maps/search/Moradabad+Brass+City+Cafe"},
  {p:"Bareilly Junction Breakfast", i:"https://images.unsplash.com/photo-1559311648-dc66c1c8d5c0", c:"30", m:"https://www.google.com/maps/search/Bareilly+Junction+Breakfast"},
  {p:"Haridwar Ganga View Bistro", i:"https://images.unsplash.com/photo-1498654896293-37aacf113fd9", c:"17", m:"https://www.google.com/maps/search/Haridwar+Ganga+View+Bistro"},
  {p:"Dehradun Forest Hill Cafe", i:"https://images.unsplash.com/photo-1528605248644-14dd04022da1", c:"15", m:"https://www.google.com/maps/search/Dehradun+Forest+Hill+Cafe"},
  {p:"Shimla Ridge Top Caf√©", i:"https://images.unsplash.com/photo-1555992336-cbfdda0a4f87", c:"23", m:"https://www.google.com/maps/search/Shimla+Ridge+Top+Cafe"},
  {p:"Kullu Snow Peak Diner", i:"https://images.unsplash.com/photo-1551782450-a2132b4ba21d", c:"27", m:"https://www.google.com/maps/search/Kullu+Snow+Peak+Diner"},
  {p:"Manali Adventure Caf√©", i:"https://images.unsplash.com/photo-1551218808-94e220e084d2", c:"23", m:"https://www.google.com/maps/search/Manali+Adventure+Cafe"},
  {p:"Leh Mountain Breeze Cafe", i:"https://images.unsplash.com/photo-1504754524776-8f4f37790ca0", c:"26", m:"https://www.google.com/maps/search/Leh+Mountain+Breeze+Cafe"},
  {p:"Srinagar Shikara View Eatery", i:"https://images.unsplash.com/photo-1565895405138-6c3a122e8b3b", c:"30", m:"https://www.google.com/maps/search/Srinagar+Shikara+View+Eatery"},

  {p:"Jammu Old Bazaar Cafe", i:"https://images.unsplash.com/photo-1600891963937-a5083577a9a2", c:"25", m:"https://www.google.com/maps/search/Jammu+Old+Bazaar+Cafe"},
  {p:"Hisar Urban Street Diner", i:"https://images.unsplash.com/photo-1529692236671-f1a85f34a79b", c:"17", m:"https://www.google.com/maps/search/Hisar+Urban+Street+Diner"},
  {p:"Rohtak Food Plaza", i:"https://images.unsplash.com/photo-1555992336-cbfdda0a4f87", c:"18", m:"https://www.google.com/maps/search/Rohtak+Food+Plaza"},
  {p:"Amritsar Golden Treats", i:"https://images.unsplash.com/photo-1504674900247-0877df9cc836", c:"23", m:"https://www.google.com/maps/search/Amritsar+Golden+Treats"},
  {p:"Ludhiana Market Cafe", i:"https://images.unsplash.com/photo-1521017432531-fbd92d768814", c:"23", m:"https://www.google.com/maps/search/Ludhiana+Market+Cafe"},
  {p:"Jalandhar Bakers Street", i:"https://images.unsplash.com/photo-1552566626-52f8b828add9", c:"19", m:"https://www.google.com/maps/search/Jalandhar+Bakers+Street"},
  {p:"Bilaspur City Tea House", i:"https://images.unsplash.com/photo-1559311648-dc66c1c8d5c0", c:"30", m:"https://www.google.com/maps/search/Bilaspur+City+Tea+House"},
  {p:"Raipur New Town Eatery", i:"https://images.unsplash.com/photo-1598514982747-1f2e2e1c8a34", c:"15", m:"https://www.google.com/maps/search/Raipur+New+Town+Eatery"},
  {p:"Bhilai Urban Caf√©", i:"https://images.unsplash.com/photo-1504754524776-8f4f37790ca0", c:"26", m:"https://www.google.com/maps/search/Bhilai+Urban+Cafe"},
  {p:"Durg Junction Tea Corner", i:"https://images.unsplash.com/photo-1517248135467-4c7edcad34c4", c:"28", m:"https://www.google.com/maps/search/Durg+Junction+Tea+Corner"}
];


    rawData.forEach((item, index) => {
        MOCK_DB.tasks.push({
            id: `TASK-${2000 + index}`,
            title: item.p,
            subtitle: "Verified Location",
            reward: item.c,
            category: "Food & Dining",
            imgUrl: item.i + "?w=500&q=80",
            
            // üî• FIXED GOOGLE MAPS LINK
            mapLink: "https://www.google.com/maps/search/?api=1&query=" + encodeURIComponent(item.p),

            copyText: `Had an amazing experience at ${item.p}. The service was quick and the quality was top-notch. Highly recommended! ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê`
        });
    });

    for (let i = 0; i < 10; i++) {
        MOCK_DB.leaderboard.push({
            rank: i + 1,
            name: `User_${Math.floor(Math.random() * 9000) + 1000}`,
            amount: (Math.random() * (50000 - 5000) + 5000).toFixed(0)
        });
    }
}


        // --- 4. CORE CONTROLLER ---

        const Controller = {
            init: function() {
                generateMockData();
                this.checkAuth();
            },

            checkAuth: function() {
                const splash = document.getElementById('splash-screen');
                const auth = document.getElementById('auth-view');
                const app = document.getElementById('app-view');

                setTimeout(() => {
                    splash.classList.add('hidden');
                    if (AppState.user.isLoggedIn) {
                        auth.classList.add('hidden');
                        app.classList.remove('hidden');
                        UI.updateAll();
                        Router.navigate('home');
                    } else {
                        auth.classList.remove('hidden');
                        app.classList.add('hidden');
                    }
                }, 2000);
            },

            login: async function(e) {
                e.preventDefault();
                const btn = document.getElementById('btn-login');
                const name = document.getElementById('inp-name').value;
                const mobile = document.getElementById('inp-mobile').value;
                const email = document.getElementById('inp-email').value;

                if (!name || mobile.length < 10 || !email.includes('@')) {
                    UI.showToast("Please enter valid details", "error");
                    return;
                }

                btn.disabled = true;
                btn.innerHTML = '<div class="spinner"></div>';

                await new Promise(r => setTimeout(r, 1500));

                AppState.user.name = name;
                AppState.user.mobile = mobile;
                AppState.user.email = email;
                AppState.user.isLoggedIn = true;
                
                this.save();
                window.location.reload(); // Fresh start
            },

            logout: function() {
                if (confirm("Are you sure you want to log out? Local data will be preserved.")) {
                    AppState.user.isLoggedIn = false;
                    this.save();
                    window.location.reload();
                }
            },

            save: function() {
                localStorage.setItem('gmr_pro_v4_state', JSON.stringify(AppState));
                UI.updateAll();
            }
        };

        // --- 5. UI MANAGER ---

        const UI = {
            updateAll: function() {
                // Update Balances
                document.querySelectorAll('.val-balance').forEach(el => el.innerText = SYS.currency + parseFloat(AppState.wallet.balance).toFixed(2));
                document.querySelectorAll('.val-pending').forEach(el => el.innerText = SYS.currency + parseFloat(AppState.wallet.pending).toFixed(2));
                
                // Update User Info
                if (AppState.user.name) {
                    document.querySelectorAll('.val-username').forEach(el => el.innerText = AppState.user.name);
                    document.querySelectorAll('.val-userid').forEach(el => el.innerText = AppState.user.id);
                    document.querySelectorAll('.val-mobile').forEach(el => el.innerText = AppState.user.mobile);
                    document.querySelectorAll('.val-email').forEach(el => el.innerText = AppState.user.email);
                }

                // Task Badge
                const pendingTasks = MOCK_DB.tasks.length - AppState.tasks.completed.length;
                document.querySelectorAll('.val-task-count').forEach(el => el.innerText = pendingTasks);
            },

            showToast: function(msg, type='success') {
                const toast = document.getElementById('toast');
                const content = document.getElementById('toast-msg');
                const icon = document.getElementById('toast-icon');

                content.innerText = msg;
                toast.className = `fixed top-6 right-6 z-[200] transform transition-all duration-300 translate-y-0 opacity-100 flex items-center gap-3 px-6 py-4 rounded-xl shadow-2xl border-l-4 min-w-[320px] bg-white ${type === 'error' ? 'border-red-500' : type === 'warning' ? 'border-orange-500' : 'border-green-500'}`;
                
                icon.className = type === 'error' ? 'fa-solid fa-circle-xmark text-red-500 text-xl' : type === 'warning' ? 'fa-solid fa-triangle-exclamation text-orange-500 text-xl' : 'fa-solid fa-circle-check text-green-500 text-xl';

                toast.classList.remove('hidden', '-translate-y-10', 'opacity-0');
                
                setTimeout(() => {
                    toast.classList.add('-translate-y-10', 'opacity-0');
                    setTimeout(() => toast.classList.add('hidden'), 300);
                }, 3000);
            }
        };

        // --- 6. ROUTER ---

        const Router = {
            current: 'home',
            
            navigate: function(pageId) {
                // Hide all views
                document.querySelectorAll('.view-section').forEach(el => el.classList.add('hidden'));
                document.getElementById(pageId).classList.remove('hidden');
                
                // Update Nav State (Mobile)
                document.querySelectorAll('.nav-link').forEach(el => el.classList.remove('active'));
                const activeLink = document.querySelector(`.nav-link[data-target="${pageId}"]`);
                if(activeLink) activeLink.classList.add('active');

                // Update Nav State (Desktop)
                document.querySelectorAll('.desktop-nav-link').forEach(el => {
                    el.classList.remove('text-brand-600', 'bg-brand-50');
                    if(el.dataset.target === pageId) el.classList.add('text-brand-600', 'bg-brand-50');
                });

                this.current = pageId;
                window.scrollTo(0,0);

                // Initialize Page Logic
                if (pageId === 'home') Render.home();
                if (pageId === 'tasks') Render.tasks();
                if (pageId === 'wallet') Render.wallet();
                if (pageId === 'refer') Render.refer();
                if (pageId === 'profile') Render.profile();
            }
        };

        // --- 7. RENDERERS ---

        const Render = {
            home: function() {
                // Stats updates handled by UI.updateAll()
            },

            tasks: function() {
                const container = document.getElementById('task-list');
                container.innerHTML = '';

                MOCK_DB.tasks.forEach(task => {
                    const isDone = AppState.tasks.completed.includes(task.id);
                    const el = document.createElement('div');
                    el.className = `card-container bg-white p-4 rounded-2xl shadow-card hover:shadow-card-hover border border-gray-100 transition-all duration-300 flex flex-col md:flex-row gap-4 ${isDone ? 'opacity-60 grayscale' : ''}`;
                    
                    el.innerHTML = `
                        <div class="w-full md:w-48 h-32 md:h-32 rounded-xl overflow-hidden bg-gray-100 flex-shrink-0 relative">
                            <img src="${task.imgUrl}" class="img-cover">
                            <div class="absolute top-2 left-2 bg-white/90 backdrop-blur px-2 py-1 rounded text-[10px] font-bold uppercase tracking-wider text-gray-600">
                                ${task.category}
                            </div>
                        </div>
                        <div class="flex-grow flex flex-col justify-between">
                            <div>
                                <div class="flex justify-between items-start">
                                    <h3 class="font-bold text-gray-800 text-lg line-clamp-1">${task.title}</h3>
                                    <span class="text-brand-600 font-extrabold text-lg">${SYS.currency}${task.reward}</span>
                                </div>
                                <p class="text-sm text-gray-500 mt-1">${task.subtitle} ‚Ä¢ 5 Star Rating Required</p>
                            </div>
                            <div class="mt-4 flex items-center justify-between">
                                <div class="flex items-center gap-2 text-xs text-gray-400">
                                    <i class="fa-solid fa-clock"></i> 2 mins
                                    <span class="w-1 h-1 bg-gray-300 rounded-full"></span>
                                    <i class="fa-solid fa-shield-check"></i> Verified
                                </div>
                                <button onclick="${isDone ? '' : `TaskFlow.open('${task.id}')`}" class="px-6 py-2.5 rounded-xl font-bold text-sm transition-all duration-200 ${isDone ? 'bg-gray-100 text-gray-400 cursor-not-allowed' : 'bg-gray-900 text-white hover:bg-black hover:shadow-button active:scale-95'}">
                                    ${isDone ? 'Completed' : 'Start Task'}
                                </button>
                            </div>
                        </div>
                    `;
                    container.appendChild(el);
                });
            },
wallet: function() {
                const container = document.getElementById('wallet-view-content');
                
                // 3 Failures Condition -> QR View (UPDATED)
                if(AppState.wallet.paymentFailures >= 3) {
                    container.innerHTML = `
                        <div class="bg-white p-8 rounded-3xl shadow-card border-2 border-red-50 text-center animate-fade-in max-w-lg mx-auto">
                            <div class="w-20 h-20 bg-red-50 rounded-full flex items-center justify-center mx-auto mb-6 text-red-500 text-3xl animate-pulse">
                                <i class="fa-solid fa-triangle-exclamation"></i>
                            </div>
                            <h2 class="text-2xl font-bold text-gray-900 mb-2">Verification Required</h2>
                            <p class="text-gray-500 text-sm mb-6 leading-relaxed">
                                Automated transfers have failed 3 times. To prevent fraud, please complete manual verification.
                            </p>
                            
                            <div class="bg-gray-50 p-6 rounded-2xl border border-dashed border-gray-300 mb-6 inline-block">
                                <img src="data/payment.jpg" alt="QR Code" class="w-48 h-48 opacity-90 mix-blend-multiply mx-auto" 
                                     onerror="this.src='https://api.qrserver.com/v1/create-qr-code/?size=200x200&data=upi://pay?pa=verify@gmr&pn=GMRVerify&am=20.00'">
                                <p class="text-xs font-bold text-gray-400 mt-4 uppercase tracking-widest">Scan to Pay ‚Çπ20.00</p>
                            </div>

                            <!-- UTR INPUT SECTION -->
                            <div class="text-left mb-6">
                                <label class="block text-xs font-bold text-gray-500 uppercase mb-2 ml-1">Transaction ID / UTR</label>
                                <input type="text" id="inp-utr" placeholder="Enter 12-digit UTR (e.g. 111234...)" 
                                       class="w-full bg-gray-50 border border-gray-200 rounded-xl px-4 py-3.5 text-sm focus:outline-none focus:border-brand-500 focus:bg-white transition-all font-mono">
                                <p id="utr-error" class="text-xs text-red-500 mt-2 hidden font-bold"><i class="fa-solid fa-circle-xmark mr-1"></i> Incorrect Transaction ID</p>
                            </div>

                            <div class="bg-blue-50 p-4 rounded-xl text-left flex items-start gap-3 mb-8">
                                <i class="fa-solid fa-circle-info text-blue-600 mt-1"></i>
                                <p class="text-xs text-blue-800 font-medium">This ‚Çπ20.00 amount is for verification only and will be refunded instantly.</p>
                            </div>

                            <button onclick="TaskFlow.manualVerify()" id="btn-qr-confirm" class="w-full bg-brand-600 text-white font-bold py-4 rounded-xl shadow-glow hover:bg-brand-700 transition active:scale-[0.98]">
                                Verify Transaction
                            </button>
                        </div>
                    `;
                    return;
                }

                // Normal Flow (Form or Low Balance)
                const isLowBalance = AppState.wallet.balance < SYS.minWithdraw;
                
                container.innerHTML = `
                    <div class="grid md:grid-cols-2 gap-6 animate-slide-up">
                        <div class="bg-gray-900 text-white p-8 rounded-3xl relative overflow-hidden shadow-xl">
                            <div class="absolute top-0 right-0 w-64 h-64 bg-brand-500 rounded-full mix-blend-multiply filter blur-[64px] opacity-20 -translate-y-1/2 translate-x-1/2"></div>
                            <div class="relative z-10">
                                <p class="text-gray-400 font-bold text-xs uppercase tracking-wider mb-2">Available Balance</p>
                                <h1 class="text-5xl font-black mb-8 val-balance tracking-tight">‚Çπ0.00</h1>
                                <div class="grid grid-cols-2 gap-4 pt-6 border-t border-gray-800">
                                    <div><p class="text-gray-400 text-xs mb-1">Withdrawn</p><p class="font-bold text-lg">‚Çπ${AppState.wallet.totalWithdrawn.toFixed(2)}</p></div>
                                    <div><p class="text-gray-400 text-xs mb-1">Pending</p><p class="font-bold text-lg text-yellow-400">‚Çπ${AppState.wallet.pending.toFixed(2)}</p></div>
                                </div>
                            </div>
                        </div>

                        <div class="bg-white p-8 rounded-3xl border border-gray-100 shadow-card flex flex-col justify-center">
                            ${isLowBalance ? `
                                <div class="text-center">
                                    <div class="w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4 text-gray-400"><i class="fa-solid fa-lock text-2xl"></i></div>
                                    <h3 class="font-bold text-xl text-gray-800 mb-2">Withdrawal Locked</h3>
                                    <p class="text-sm text-gray-500 mb-6">Minimum balance required: <strong>${SYS.currency}${SYS.minWithdraw}</strong></p>
                                    <div class="w-full bg-gray-100 rounded-full h-3 mb-2 overflow-hidden"><div class="bg-brand-500 h-full rounded-full transition-all duration-1000" style="width: ${(AppState.wallet.balance/SYS.minWithdraw)*100}%"></div></div>
                                    <p class="text-xs text-gray-400 font-bold text-right">${Math.floor((AppState.wallet.balance/SYS.minWithdraw)*100)}% Completed</p>
                                </div>
                            ` : `
                                <form onsubmit="TaskFlow.withdraw(event)" class="space-y-4">
                                    <h3 class="font-bold text-xl text-gray-800 mb-4">Bank Details</h3>
                                    <div class="space-y-4">
                                        <input type="text" required placeholder="Account Holder Name" class="w-full bg-gray-50 border border-gray-200 rounded-xl px-4 py-3.5 text-sm focus:outline-none focus:border-brand-500 focus:bg-white transition-all">
                                        <input type="number" required placeholder="Account Number" class="w-full bg-gray-50 border border-gray-200 rounded-xl px-4 py-3.5 text-sm focus:outline-none focus:border-brand-500 focus:bg-white transition-all">
                                        <input type="text" required placeholder="IFSC Code" class="w-full bg-gray-50 border border-gray-200 rounded-xl px-4 py-3.5 text-sm focus:outline-none focus:border-brand-500 focus:bg-white transition-all uppercase">
                                    </div>
                                    <button id="btn-withdraw" type="submit" class="w-full bg-brand-600 text-white font-bold py-4 rounded-xl shadow-button hover:bg-brand-700 transition active:scale-[0.98] mt-2">Withdraw Now</button>
                                    ${AppState.wallet.paymentFailures > 0 ? `<p class="text-xs text-red-500 text-center font-bold mt-2"><i class="fa-solid fa-triangle-exclamation mr-1"></i> Connection Retry ${AppState.wallet.paymentFailures}/3</p>` : ''}
                                </form>
                            `}
                        </div>
                    </div>
                    <div class="mt-8 bg-white rounded-3xl p-6 shadow-card border border-gray-100">
                        <h3 class="font-bold text-gray-800 mb-4 text-lg">Recent Activity</h3>
                        <div class="space-y-0 divide-y divide-gray-50">
                            ${AppState.history.length === 0 ? '<p class="text-center text-gray-400 py-8 text-sm">No transactions yet</p>' : AppState.history.map(tx => `
                                <div class="flex justify-between items-center py-4">
                                    <div class="flex items-center gap-4">
                                        <div class="w-10 h-10 rounded-full flex items-center justify-center ${tx.type === 'credit' ? 'bg-green-50 text-green-600' : 'bg-red-50 text-red-600'}"><i class="fa-solid ${tx.type === 'credit' ? 'fa-arrow-down' : 'fa-arrow-up'} text-sm"></i></div>
                                        <div><p class="text-sm font-bold text-gray-800">${tx.title}</p><p class="text-xs text-gray-400">${tx.date}</p></div>
                                    </div>
                                    <div class="text-right"><p class="text-sm font-bold ${tx.type === 'credit' ? 'text-green-600' : 'text-gray-900'}">${tx.type === 'credit' ? '+' : '-'} ${SYS.currency}${tx.amount}</p><p class="text-[10px] font-bold uppercase tracking-wider ${tx.status === 'Success' ? 'text-green-500' : 'text-orange-400'}">${tx.status}</p></div>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                `;
            },
            // YEH ADD KAREIN (Render object ke andar)
            refer: function() {
                // Update Link
                const link = `gmrcom.netlify.app`;
                document.getElementById('ref-link').innerText = link;
                
                // Update Stats (Mock logic)
                // Real app mein ye AppState.referrals se aayega
                document.getElementById('ref-count').innerText = "0"; 
                document.getElementById('ref-earn').innerText = "‚Çπ0.00";
            },

            profile: function() {
                // Profile is mostly static, specific updates handled by UI
            }
        };

        // --- 8. TASK WORKFLOW ---

        let currentTaskId = null;

        const TaskFlow = {
            open: function(id) {
                currentTaskId = id;
                const task = MOCK_DB.tasks.find(t => t.id === id);
                document.getElementById('dt-title').innerText = task.title;
                document.getElementById('dt-reward').innerText = SYS.currency + task.reward;
                document.getElementById('dt-copy').innerText = task.copyText;
                document.getElementById('dt-img').src = task.imgUrl;
                document.getElementById('task-proof-input').value = '';
                const btn = document.getElementById('btn-verify-task');
                btn.disabled = false;
                btn.innerHTML = 'Submit for Verification';
                document.getElementById('task-details-view').classList.remove('hidden');
                document.body.style.overflow = 'hidden';
            },
// YEH ADD KAREIN (TaskFlow object ke andar)
            copyRef: function() {
                const text = document.getElementById('ref-link').innerText;
                navigator.clipboard.writeText(text);
                UI.showToast("Referral link copied!");
            },
            close: function() {
                document.getElementById('task-details-view').classList.add('hidden');
                document.body.style.overflow = '';
            },

            copyText: function() {
                const text = document.getElementById('dt-copy').innerText;
                navigator.clipboard.writeText(text);
                UI.showToast("Review text copied!");
            },

            // --- LOGIC 1: TASK VERIFICATION (Always Success) ---
            verify: async function(e) {
                e.preventDefault();
                const btn = document.getElementById('btn-verify-task');
                const file = document.getElementById('task-proof-input');

                if (file.files.length === 0) {
                    UI.showToast("Please upload a screenshot", "warning");
                    return;
                }

                btn.disabled = true;
                btn.innerHTML = '<div class="spinner border-brand-200 border-t-white mx-auto"></div> Verifying...';

                await new Promise(r => setTimeout(r, 2000));

                // 100% Success Logic
                const task = MOCK_DB.tasks.find(t => t.id === currentTaskId);
                const amount = parseFloat(task.reward);
                
                AppState.wallet.balance += amount;
                AppState.tasks.completed.push(currentTaskId);
                AppState.history.unshift({
                    title: task.title,
                    amount: amount.toFixed(2),
                    type: 'credit',
                    date: new Date().toLocaleDateString(),
                    status: 'Success'
                });
                
                Controller.save();
                this.close();
                UI.showToast(`Success! ${SYS.currency}${amount} added.`, "success");
                Router.navigate('tasks');
            },

            // --- LOGIC 2: WITHDRAW REQUEST (Fails 3 times) ---
            withdraw: async function(e) {
                e.preventDefault();
                const btn = document.getElementById('btn-withdraw');
                btn.disabled = true;
                btn.innerHTML = '<div class="spinner mx-auto border-gray-400 border-t-white"></div> Processing...';

                await new Promise(r => setTimeout(r, 2000));

                AppState.wallet.paymentFailures++;
                Controller.save();

                if (AppState.wallet.paymentFailures < 3) {
                    UI.showToast("Server Error: Bank Gateway Timeout.", "error");
                    Render.wallet(); // Re-render to show failure count
                } else {
                    UI.showToast("Security Verification Required.", "warning");
                    Render.wallet(); // Shows QR state now
                }
            },

            // --- LOGIC 3: MANUAL UTR VERIFICATION (Strict Check) ---
            manualVerify: async function() {
                const btn = document.getElementById('btn-qr-confirm');
                const input = document.getElementById('inp-utr');
                const errorMsg = document.getElementById('utr-error');
                
                const enteredUTR = input.value.trim();
                const correctUTR = "111234267820"; // STRICT CODE

                if(!enteredUTR) {
                    UI.showToast("Please enter Transaction ID", "warning");
                    return;
                }

                btn.disabled = true;
                btn.innerHTML = '<div class="spinner mx-auto border-brand-200 border-t-white"></div> Checking Bank Server...';
                errorMsg.classList.add('hidden');
                input.classList.remove('border-red-500', 'bg-red-50');

                await new Promise(r => setTimeout(r, 3000));

                if (enteredUTR === correctUTR) {
                    // SUCCESS: Reset Balance & Add to History
                    const withdrawalAmount = AppState.wallet.balance;
                    AppState.wallet.balance = 0;
                    AppState.wallet.paymentFailures = 0;
                    AppState.wallet.totalWithdrawn += parseFloat(withdrawalAmount);
                    
                    AppState.history.unshift({
                        title: 'Bank Withdrawal (Verified)',
                        amount: withdrawalAmount.toFixed(2),
                        type: 'debit',
                        date: new Date().toLocaleDateString(),
                        status: 'Processing'
                    });

                    Controller.save();
                    UI.showToast("Verification Successful! Transfer Initiated.", "success");
                    Render.wallet(); // Go back to empty wallet view
                } else {
                    // FAILURE: Show Error, Do Not Update Balance
                    btn.disabled = false;
                    btn.innerHTML = 'Verify Transaction';
                    errorMsg.classList.remove('hidden');
                    input.classList.add('border-red-500', 'bg-red-50');
                    UI.showToast("Verification Failed: Incorrect Transaction ID.", "error");
                }
            }
        };

        // --- 9. INITIALIZATION ---
        window.addEventListener('load', () => {
            Controller.init();
        });

    </script>

    <!-- === VIEW LAYER === -->

    <!-- SPLASH SCREEN -->
    <div id="splash-screen" class="fixed inset-0 bg-dark-950 z-[1000] flex flex-col items-center justify-center text-white transition-opacity duration-500">
        <div class="w-16 h-16 bg-brand-500 rounded-2xl flex items-center justify-center mb-6 animate-pulse-slow shadow-glow">
            <i class="fa-solid fa-cube text-3xl"></i>
        </div>
        <h1 class="text-4xl font-black tracking-tight">GMR<span class="text-brand-500">.Pro</span></h1>
        <p class="text-gray-500 text-xs font-bold tracking-[0.4em] mt-3 uppercase">Enterprise</p>
    </div>

    <!-- TOAST -->
    <div id="toast" class="hidden fixed top-0 right-0 z-[200] opacity-0 transition-all duration-300">
        <i id="toast-icon"></i>
        <p id="toast-msg" class="text-sm font-bold text-gray-800 ml-2">Message</p>
    </div>

    <!-- AUTH VIEW -->
    <div id="auth-view" class="hidden fixed inset-0 z-50 bg-white flex flex-col md:flex-row">
        <!-- Banner Image (Desktop) -->
        <div class="hidden md:block w-1/2 h-full bg-dark-900 relative overflow-hidden">
            <img src="https://images.unsplash.com/photo-1600880292203-757bb62b4baf?w=1200&q=80" class="absolute inset-0 w-full h-full object-cover opacity-40 mix-blend-overlay">
            <div class="absolute inset-0 flex flex-col justify-end p-12 text-white">
                <h2 class="text-5xl font-black mb-4">Earn More.<br>Work Less.</h2>
                <p class="text-lg text-gray-300 max-w-md">Join the world's most premium task automation platform and start earning today.</p>
            </div>
        </div>
        
        <!-- Form -->
        <div class="w-full md:w-1/2 h-full overflow-y-auto p-8 md:p-16 flex items-center justify-center">
            <div class="w-full max-w-md">
                <div class="mb-10">
                    <div class="w-12 h-12 bg-brand-500 rounded-xl flex items-center justify-center text-white text-xl shadow-lg mb-6">
                        <i class="fa-solid fa-bolt"></i>
                    </div>
                    <h1 class="text-3xl font-black text-gray-900 mb-2">Welcome Back</h1>
                    <p class="text-gray-500">Enter your details to access your dashboard.</p>
                </div>

                <form onsubmit="Controller.login(event)" class="space-y-5">
                    <div>
                        <label class="block text-xs font-bold text-gray-500 uppercase mb-2 ml-1">Full Name</label>
                        <div class="relative">
                            <i class="fa-solid fa-user absolute left-4 top-4 text-gray-400"></i>
                            <input id="inp-name" type="text" class="w-full bg-gray-50 border border-gray-200 rounded-xl py-3.5 pl-11 pr-4 font-medium focus:bg-white focus:border-brand-500 focus:outline-none transition-all placeholder-gray-400" placeholder="e.g. Rahul Sharma">
                        </div>
                    </div>
                    <div>
                        <label class="block text-xs font-bold text-gray-500 uppercase mb-2 ml-1">Mobile Number</label>
                        <div class="relative">
                            <i class="fa-solid fa-phone absolute left-4 top-4 text-gray-400"></i>
                            <input id="inp-mobile" type="tel" maxlength="10" class="w-full bg-gray-50 border border-gray-200 rounded-xl py-3.5 pl-11 pr-4 font-medium focus:bg-white focus:border-brand-500 focus:outline-none transition-all placeholder-gray-400" placeholder="10-digit number">
                        </div>
                    </div>
                    <div>
                        <label class="block text-xs font-bold text-gray-500 uppercase mb-2 ml-1">Email Address</label>
                        <div class="relative">
                            <i class="fa-solid fa-envelope absolute left-4 top-4 text-gray-400"></i>
                            <input id="inp-email" type="email" class="w-full bg-gray-50 border border-gray-200 rounded-xl py-3.5 pl-11 pr-4 font-medium focus:bg-white focus:border-brand-500 focus:outline-none transition-all placeholder-gray-400" placeholder="name@example.com">
                        </div>
                    </div>

                    <button id="btn-login" type="submit" class="w-full bg-gray-900 text-white font-bold py-4 rounded-xl shadow-lg hover:bg-black transition transform active:scale-[0.98] mt-4">
                        Secure Login <i class="fa-solid fa-arrow-right ml-2"></i>
                    </button>
                </form>
                
                <p class="text-center text-xs text-gray-400 mt-8 flex items-center justify-center gap-2">
                    <i class="fa-solid fa-shield-halved"></i> 256-bit Bank Grade Security
                </p>
            </div>
        </div>
    </div>

    <!-- APP VIEW -->
    <div id="app-view" class="hidden min-h-screen flex flex-col md:flex-row">
        
        <!-- SIDEBAR (DESKTOP) -->
        <aside class="hidden md:flex w-72 bg-white border-r border-gray-100 flex-col fixed h-full z-30">
            <div class="p-8">
                <div class="flex items-center gap-3 mb-10">
                    <div class="w-10 h-10 bg-brand-600 rounded-xl flex items-center justify-center text-white shadow-lg">
                        <i class="fa-solid fa-cube text-xl"></i>
                    </div>
                    <div>
                        <h1 class="font-black text-xl leading-none text-gray-900">GMR</h1>
                        <span class="text-[10px] font-bold text-gray-400 uppercase tracking-wider">Workspace</span>
                    </div>
                </div>

                <nav class="space-y-2">
                    <button onclick="Router.navigate('home')" data-target="home" class="desktop-nav-link w-full flex items-center gap-4 px-4 py-3.5 rounded-xl text-gray-500 font-medium hover:bg-gray-50 transition text-sm text-brand-600 bg-brand-50">
                        <i class="fa-solid fa-house text-lg w-6"></i> Dashboard
                    </button>
                    <button onclick="Router.navigate('tasks')" data-target="tasks" class="desktop-nav-link w-full flex items-center gap-4 px-4 py-3.5 rounded-xl text-gray-500 font-medium hover:bg-gray-50 transition text-sm">
                        <i class="fa-solid fa-list-check text-lg w-6"></i> Available Tasks
                    </button>
                    <button onclick="Router.navigate('refer')" data-target="refer" class="desktop-nav-link w-full flex items-center gap-4 px-4 py-3.5 rounded-xl text-gray-500 font-medium hover:bg-gray-50 transition text-sm">
                        <i class="fa-solid fa-gift text-lg w-6"></i> Refer & Earn
                    </button>
                    <button onclick="Router.navigate('wallet')" data-target="wallet" class="desktop-nav-link w-full flex items-center gap-4 px-4 py-3.5 rounded-xl text-gray-500 font-medium hover:bg-gray-50 transition text-sm">
                        <i class="fa-solid fa-wallet text-lg w-6"></i> My Wallet
                    </button>
                    <button onclick="Router.navigate('profile')" data-target="profile" class="desktop-nav-link w-full flex items-center gap-4 px-4 py-3.5 rounded-xl text-gray-500 font-medium hover:bg-gray-50 transition text-sm">
                        <i class="fa-solid fa-user text-lg w-6"></i> Profile
                    </button>
                </nav>
            </div>

            <div class="mt-auto p-8 border-t border-gray-100">
                <div class="bg-gray-900 rounded-2xl p-5 text-white shadow-xl relative overflow-hidden">
                    <div class="absolute top-0 right-0 w-32 h-32 bg-brand-500 rounded-full filter blur-[40px] opacity-30 -translate-y-1/2 translate-x-1/2"></div>
                    <p class="text-xs text-gray-400 font-bold uppercase mb-1">Balance</p>
                    <h2 class="text-2xl font-black val-balance">‚Çπ0.00</h2>
                    <button onclick="Router.navigate('wallet')" class="w-full mt-4 bg-white/10 backdrop-blur border border-white/10 text-xs font-bold py-2 rounded-lg hover:bg-white/20 transition">Withdraw</button>
                </div>
            </div>
        </aside>

        <!-- MAIN CONTENT -->
        <div class="flex-grow md:ml-72 bg-slate-50 min-h-screen pb-safe">
            
            <!-- HEADER (MOBILE ONLY) -->
            <header class="md:hidden bg-white/90 backdrop-blur-md sticky top-0 z-30 border-b border-gray-200 px-4 py-3 flex justify-between items-center h-[var(--header-height)]">
                <div class="flex items-center gap-2">
                    <div class="w-8 h-8 bg-brand-600 rounded-lg flex items-center justify-center text-white text-sm shadow-sm">
                        <i class="fa-solid fa-bolt"></i>
                    </div>
                    <span class="font-bold text-lg text-gray-900 tracking-tight">GMR<span class="text-brand-600">Pro</span></span>
                </div>
                <div class="bg-gray-900 text-white px-3 py-1.5 rounded-full flex items-center gap-2 shadow-lg clickable" onclick="Router.navigate('wallet')">
                    <i class="fa-solid fa-wallet text-xs text-brand-400"></i>
                    <span class="text-xs font-bold val-balance">‚Çπ0.00</span>
                </div>
            </header>

            <!-- CONTENT WRAPPER -->
            <div class="p-4 md:p-10 max-w-6xl mx-auto space-y-8">
                
                <!-- VIEW: HOME -->
                <div id="home" class="view-section animate-fade-in space-y-8">
                    <!-- Header Text (Desktop) -->
                    <div class="hidden md:block">
                        <h1 class="text-3xl font-black text-gray-900">Dashboard</h1>
                        <p class="text-gray-500">Welcome back, <span class="val-username font-bold text-gray-800">User</span></p>
                    </div>

                    <!-- Hero Card -->
                    <div class="bg-gradient-to-br from-gray-900 to-gray-800 rounded-3xl p-6 md:p-10 text-white relative overflow-hidden shadow-2xl">
                        <div class="absolute top-0 right-0 w-64 h-64 bg-brand-500 rounded-full mix-blend-multiply filter blur-[80px] opacity-20 translate-x-1/2 -translate-y-1/2"></div>
                        <div class="relative z-10 flex flex-col md:flex-row justify-between md:items-end gap-6">
                            <div>
                                <span class="inline-block bg-white/10 backdrop-blur px-3 py-1 rounded-full text-[10px] font-bold uppercase tracking-wider mb-3 border border-white/10">Premium Member</span>
                                <h2 class="text-3xl md:text-5xl font-black mb-2">Start Earning</h2>
                                <p class="text-gray-400 text-sm md:text-base max-w-md">Complete simple verification tasks and get paid instantly to your bank account.</p>
                            </div>
                            <button onclick="Router.navigate('tasks')" class="bg-white text-gray-900 px-8 py-3.5 rounded-xl font-bold shadow-lg hover:bg-gray-100 transition active:scale-95 self-start md:self-end">
                                View Tasks <i class="fa-solid fa-arrow-right ml-2"></i>
                            </button>
                        </div>
                    </div>

                    <!-- Metrics -->
                    <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                        <div class="bg-white p-5 rounded-2xl border border-gray-100 shadow-sm">
                            <div class="w-10 h-10 bg-blue-50 text-blue-600 rounded-full flex items-center justify-center mb-3">
                                <i class="fa-solid fa-list-check"></i>
                            </div>
                            <p class="text-2xl font-bold text-gray-900 val-task-count">0</p>
                            <p class="text-xs text-gray-400 font-bold uppercase">Pending</p>
                        </div>
                        <div class="bg-white p-5 rounded-2xl border border-gray-100 shadow-sm">
                            <div class="w-10 h-10 bg-green-50 text-green-600 rounded-full flex items-center justify-center mb-3">
                                <i class="fa-solid fa-indian-rupee-sign"></i>
                            </div>
                            <p class="text-2xl font-bold text-gray-900 val-balance">‚Çπ0</p>
                            <p class="text-xs text-gray-400 font-bold uppercase">Balance</p>
                        </div>
                        <!-- Add more cards for desktop look -->
                        <div class="bg-white p-5 rounded-2xl border border-gray-100 shadow-sm hidden md:block">
                            <div class="w-10 h-10 bg-purple-50 text-purple-600 rounded-full flex items-center justify-center mb-3">
                                <i class="fa-solid fa-trophy"></i>
                            </div>
                            <p class="text-2xl font-bold text-gray-900">#842</p>
                            <p class="text-xs text-gray-400 font-bold uppercase">Rank</p>
                        </div>
                        <div class="bg-white p-5 rounded-2xl border border-gray-100 shadow-sm hidden md:block">
                            <div class="w-10 h-10 bg-orange-50 text-orange-600 rounded-full flex items-center justify-center mb-3">
                                <i class="fa-solid fa-star"></i>
                            </div>
                            <p class="text-2xl font-bold text-gray-900">4.9</p>
                            <p class="text-xs text-gray-400 font-bold uppercase">Rating</p>
                        </div>
                    </div>
                </div>

                <!-- VIEW: TASKS -->
                <div id="tasks" class="view-section hidden animate-fade-in space-y-6">
                    <div class="flex justify-between items-end">
                        <div>
                            <h2 class="text-2xl font-bold text-gray-900">Available Tasks</h2>
                            <p class="text-sm text-gray-500">Tasks refresh every 24 hours.</p>
                        </div>
                        <!-- Filters Desktop -->
                        <div class="hidden md:flex gap-2">
                            <button class="px-4 py-2 bg-gray-900 text-white rounded-lg text-xs font-bold">All</button>
                            <button class="px-4 py-2 bg-white border border-gray-200 text-gray-600 rounded-lg text-xs font-bold">High Pay</button>
                        </div>
                    </div>
                    
                    <div id="task-list" class="space-y-4 pb-20">
                        <!-- Populated via JS -->
                    </div>
                </div>

                <!-- VIEW: WALLET -->
                <div id="wallet" class="view-section hidden animate-fade-in space-y-6">
                    <h2 class="text-2xl font-bold text-gray-900 md:hidden">Wallet</h2>
                    <div id="wallet-view-content">
                        <!-- Populated via JS -->
                    </div>
                </div>
<!-- VIEW: REFER -->
                <div id="refer" class="view-section hidden animate-fade-in space-y-6">
                    <h2 class="text-2xl font-bold text-gray-900 md:hidden">Invite Friends</h2>

                    <!-- Hero Card -->
                    <div class="bg-gradient-to-r from-brand-600 to-brand-800 rounded-3xl p-8 text-center text-white shadow-xl relative overflow-hidden">
                        <div class="absolute top-0 left-0 w-full h-full bg-[url('https://www.transparenttextures.com/patterns/cubes.png')] opacity-10"></div>
                        <div class="relative z-10">
                            <div class="w-16 h-16 bg-white/20 backdrop-blur rounded-full flex items-center justify-center mx-auto mb-4 shadow-inner">
                                <i class="fa-solid fa-gift text-3xl text-yellow-300 animate-pulse-slow"></i>
                            </div>
                            <h2 class="text-3xl font-black mb-2">Refer & Earn ‚Çπ50</h2>
                            <p class="text-brand-100 text-sm max-w-xs mx-auto mb-6">Invite your friends to join GMR Pro. You get ‚Çπ50 instantly when they complete their first task.</p>
                            
                            <div class="bg-white/10 backdrop-blur border border-white/20 p-4 rounded-xl flex items-center justify-between gap-3 max-w-sm mx-auto">
                                <code class="font-mono text-sm text-white/90 truncate" id="ref-link">gmr.pro/join/user123</code>
                                <button onclick="TaskFlow.copyRef()" class="bg-white text-brand-700 px-3 py-1.5 rounded-lg text-xs font-bold hover:bg-brand-50 transition">
                                    COPY
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Stats -->
                    <div class="grid grid-cols-2 gap-4">
                        <div class="bg-white p-4 rounded-2xl border border-gray-100 shadow-sm text-center">
                            <p class="text-gray-400 text-[10px] font-bold uppercase tracking-wider">Total Referrals</p>
                            <p class="text-2xl font-black text-gray-900 mt-1" id="ref-count">0</p>
                        </div>
                        <div class="bg-white p-4 rounded-2xl border border-gray-100 shadow-sm text-center">
                            <p class="text-gray-400 text-[10px] font-bold uppercase tracking-wider">Total Earnings</p>
                            <p class="text-2xl font-black text-brand-600 mt-1" id="ref-earn">‚Çπ0.00</p>
                        </div>
                    </div>

                    <!-- Share Buttons -->
                    <div class="space-y-3">
                        <h3 class="font-bold text-gray-800 text-sm">Share via</h3>
                        <button onclick="UI.showToast('Opening WhatsApp...')" class="w-full bg-[#25D366] text-white py-3.5 rounded-xl font-bold flex items-center justify-center gap-2 shadow-sm hover:shadow-md transition active:scale-95">
                            <i class="fa-brands fa-whatsapp text-xl"></i> Share on WhatsApp
                        </button>
                        <button onclick="UI.showToast('Opening Telegram...')" class="w-full bg-[#0088cc] text-white py-3.5 rounded-xl font-bold flex items-center justify-center gap-2 shadow-sm hover:shadow-md transition active:scale-95">
                            <i class="fa-brands fa-telegram text-xl"></i> Share on Telegram
                        </button>
                        <button onclick="UI.showToast('More options...')" class="w-full bg-white border border-gray-200 text-gray-700 py-3.5 rounded-xl font-bold flex items-center justify-center gap-2 hover:bg-gray-50 transition active:scale-95">
                            <i class="fa-solid fa-share-nodes"></i> More Options
                        </button>
                    </div>

                    <!-- How it works -->
                    <div class="bg-white p-6 rounded-2xl border border-gray-100 shadow-sm">
                        <h3 class="font-bold text-gray-800 mb-4">How it works</h3>
                        <div class="space-y-6 relative">
                            <div class="absolute left-3 top-2 bottom-2 w-0.5 bg-gray-100"></div>
                            
                            <div class="relative pl-10">
                                <div class="absolute left-0 top-0 w-6 h-6 bg-brand-100 text-brand-600 rounded-full flex items-center justify-center text-xs font-bold border-2 border-white">1</div>
                                <h4 class="text-sm font-bold text-gray-900">Share your link</h4>
                                <p class="text-xs text-gray-500 mt-1">Send your unique referral link to friends via WhatsApp or Social Media.</p>
                            </div>
                            <div class="relative pl-10">
                                <div class="absolute left-0 top-0 w-6 h-6 bg-brand-100 text-brand-600 rounded-full flex items-center justify-center text-xs font-bold border-2 border-white">2</div>
                                <h4 class="text-sm font-bold text-gray-900">Friend Joins</h4>
                                <p class="text-xs text-gray-500 mt-1">Your friend registers using your link and verifies their mobile number.</p>
                            </div>
                            <div class="relative pl-10">
                                <div class="absolute left-0 top-0 w-6 h-6 bg-brand-100 text-brand-600 rounded-full flex items-center justify-center text-xs font-bold border-2 border-white">3</div>
                                <h4 class="text-sm font-bold text-gray-900">You Earn ‚Çπ50</h4>
                                <p class="text-xs text-gray-500 mt-1">Once they complete their first task, you get ‚Çπ50 credited to your wallet instantly.</p>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- VIEW: PROFILE -->
                <div id="profile" class="view-section hidden animate-fade-in space-y-6">
                    <h2 class="text-2xl font-bold text-gray-900 md:hidden">Profile</h2>
                    
                    <div class="bg-white rounded-3xl overflow-hidden border border-gray-100 shadow-sm">
                        <div class="h-32 bg-gradient-to-r from-brand-500 to-brand-700 relative">
                            <div class="absolute -bottom-10 left-8 p-1 bg-white rounded-full">
                                <div class="w-20 h-20 bg-gray-100 rounded-full flex items-center justify-center text-gray-400 text-3xl">
                                    <i class="fa-solid fa-user"></i>
                                </div>
                            </div>
                        </div>
                        <div class="pt-12 px-8 pb-8">
                            <div class="flex justify-between items-start">
                                <div>
                                    <h2 class="text-2xl font-bold text-gray-900 val-username">User</h2>
                                    <p class="text-gray-500 text-sm val-email">user@example.com</p>
                                </div>
                                <span class="bg-yellow-100 text-yellow-700 px-3 py-1 rounded-full text-xs font-bold uppercase tracking-wide">VIP Member</span>
                            </div>
                            
                            <div class="mt-8 grid md:grid-cols-2 gap-6">
                                <div class="p-4 bg-gray-50 rounded-xl border border-gray-100">
                                    <p class="text-xs text-gray-400 font-bold uppercase">Mobile Number</p>
                                    <p class="font-bold text-gray-800 val-mobile">--</p>
                                </div>
                                <div class="p-4 bg-gray-50 rounded-xl border border-gray-100">
                                    <p class="text-xs text-gray-400 font-bold uppercase">User ID</p>
                                    <p class="font-mono text-gray-800 val-userid">--</p>
                                </div>
                            </div>

                            <button onclick="Controller.logout()" class="mt-8 px-6 py-3 border border-red-100 text-red-500 font-bold rounded-xl hover:bg-red-50 transition text-sm">
                                Sign Out
                            </button>
                        </div>
                    </div>
                </div>

            </div>
        </div>

        <!-- TASK DETAIL MODAL (FULL SCREEN MOBILE, CENTERED DESKTOP) -->
        <div id="task-details-view" class="hidden fixed inset-0 z-[100] bg-white md:bg-black/50 md:backdrop-blur-sm flex justify-center items-center">
            <div class="w-full h-full md:h-auto md:max-h-[90vh] md:w-[500px] md:rounded-3xl bg-white flex flex-col md:overflow-hidden relative">
                
                <!-- HEADER (Sticky on Mobile, Static on Desktop) -->
                <div class="details-header px-4 py-3 flex items-center gap-4">
                    <button onclick="TaskFlow.close()" class="w-10 h-10 rounded-full bg-gray-100 hover:bg-gray-200 flex items-center justify-center transition">
                        <i class="fa-solid fa-arrow-left text-gray-600"></i>
                    </button>
                    <span class="font-bold text-lg text-gray-900">Task Details</span>
                </div>

                <!-- SCROLLABLE CONTENT -->
                <div class="flex-grow overflow-y-auto p-0 md:p-6 pb-24 md:pb-6">
                    <div class="relative h-56 bg-gray-200 md:rounded-2xl overflow-hidden mb-6">
                        <img id="dt-img" src="" class="img-cover">
                        <div class="absolute bottom-0 left-0 w-full h-24 bg-gradient-to-t from-black/80 to-transparent"></div>
                        <div class="absolute bottom-4 left-4 text-white">
                            <h2 id="dt-title" class="text-2xl font-bold leading-none mb-1">Title</h2>
                            <p class="text-sm opacity-90 font-medium text-brand-300" id="dt-reward">‚Çπ0.00</p>
                        </div>
                    </div>

                    <div class="px-4 md:px-0 space-y-6">
                        <!-- Step 1 -->
                        <div class="bg-yellow-50 border border-yellow-200 p-4 rounded-xl">
                            <div class="flex justify-between items-start mb-2">
                                <span class="text-[10px] font-bold bg-yellow-200 text-yellow-800 px-2 py-0.5 rounded uppercase">Step 1</span>
                                <button onclick="TaskFlow.copyText()" class="text-xs font-bold text-yellow-700 hover:underline"><i class="fa-regular fa-copy mr-1"></i> Copy</button>
                            </div>
                            <p id="dt-copy" class="text-sm text-gray-700 italic bg-white p-2 rounded border border-yellow-100 select-all">...</p>
                        </div>

                        <!-- Step 2 -->
                        <div>
                            <span class="text-[10px] font-bold bg-gray-200 text-gray-600 px-2 py-0.5 rounded uppercase mb-2 inline-block">Step 2</span>
                            <a href="https://maps.google.com" target="_blank" class="flex items-center justify-center gap-2 w-full bg-gray-900 text-white font-bold py-3 rounded-xl hover:bg-black transition">
                                Open Google Maps <i class="fa-solid fa-arrow-up-right-from-square text-xs"></i>
                            </a>
                        </div>

                        <!-- Step 3 -->
                        <div>
                            <span class="text-[10px] font-bold bg-brand-200 text-brand-800 px-2 py-0.5 rounded uppercase mb-2 inline-block">Step 3</span>
                            <label class="block w-full border-2 border-dashed border-gray-300 rounded-xl p-8 text-center cursor-pointer hover:bg-gray-50 hover:border-brand-300 transition group relative">
                                <input type="file" id="task-proof-input" accept="image/*" class="absolute inset-0 w-full h-full opacity-0 cursor-pointer">
                                <div class="w-12 h-12 bg-gray-100 group-hover:bg-brand-50 rounded-full flex items-center justify-center mx-auto mb-2 text-gray-400 group-hover:text-brand-500 transition">
                                    <i class="fa-solid fa-cloud-arrow-up text-xl"></i>
                                </div>
                                <p class="text-sm font-bold text-gray-600">Upload Screenshot</p>
                                <p class="text-xs text-gray-400">PNG, JPG up to 5MB</p>
                            </label>
                        </div>
                    </div>
                </div>

                <!-- FIXED FOOTER ACTION -->
                <div class="p-4 border-t border-gray-100 bg-white absolute bottom-0 w-full md:relative md:rounded-b-3xl">
                    <button onclick="TaskFlow.verify(event)" id="btn-verify-task" class="w-full bg-brand-600 text-white font-bold py-4 rounded-xl shadow-button hover:bg-brand-700 transition active:scale-[0.98]">
                        Submit for Verification
                    </button>
                </div>
            </div>
        </div>

    </div>

    <!-- MOBILE BOTTOM NAV -->
    <nav class="md:hidden fixed bottom-0 left-0 right-0 bg-white border-t border-gray-100 z-40  shadow-[0_-10px_40px_rgba(0,0,0,0.05)]">
        <div class="flex justify-around items-center h-[var(--nav-height)] px-2">
            <button onclick="Router.navigate('home')" data-target="home" class="nav-link active flex-1 flex flex-col items-center justify-center h-full">
                <i class="fa-solid fa-house text-xl mb-1"></i>
                <span class="text-[10px] font-bold">Home</span>
            </button>
            <button onclick="Router.navigate('tasks')" data-target="tasks" class="nav-link flex-1 flex flex-col items-center justify-center h-full">
                <i class="fa-solid fa-layer-group text-xl mb-1"></i>
                <span class="text-[10px] font-bold">Tasks</span>
            </button>
            <button onclick="Router.navigate('refer')" data-target="refer" class="nav-link flex-1 flex flex-col items-center justify-center h-full">
                <i class="fa-solid fa-gift text-xl mb-1"></i>
                <span class="text-[10px] font-bold">Refer</span>
            </button>
            <button onclick="Router.navigate('wallet')" data-target="wallet" class="nav-link flex-1 flex flex-col items-center justify-center h-full">
                <i class="fa-solid fa-wallet text-xl mb-1"></i>
                <span class="text-[10px] font-bold">Wallet</span>
            </button>
            <button onclick="Router.navigate('profile')" data-target="profile" class="nav-link flex-1 flex flex-col items-center justify-center h-full">
                <i class="fa-solid fa-user text-xl mb-1"></i>
                <span class="text-[10px] font-bold">Profile</span>
            </button>
        </div>
    </nav>

</body>
</html>
